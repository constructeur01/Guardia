<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Paint Simple</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        #toolbar {
            background-color: #333;
            color: #fff;
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        #toolbar button, #toolbar input, #toolbar select {
            background-color: #555;
            color: #fff;
            border: 1px solid #777;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }
        #toolbar button:hover {
            background-color: #666;
        }
        #toolbar button.active {
            background-color: #777;
        }
        #canvasContainer {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #fff;
            border: 1px solid #ccc;
        }
        #canvas {
            border: 1px solid #000;
            cursor: crosshair;
            background-color: #fff;
        }
        #saveBtn {
            background-color: #4CAF50;
            margin-left: auto;
        }
        #saveBtn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div id="toolbar">
        <button id="pencil" class="active">Crayon</button>
        <button id="eraser">Gomme</button>
        <button id="line">Ligne</button>
        <button id="rect">Rectangle</button>
        <button id="circle">Cercle</button>
        <button id="fill">Remplissage</button>
        <label>Taille: <input type="range" id="brushSize" min="1" max="50" value="5"></label>
        <label>Couleur: <input type="color" id="color" value="#000000"></label>
        <button id="clear">Effacer</button>
        <button id="saveBtn">Sauvegarder</button>
    </div>
    <div id="canvasContainer">
        <canvas id="canvas" width="800" height="600"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const pencilBtn = document.getElementById('pencil');
        const eraserBtn = document.getElementById('eraser');
        const lineBtn = document.getElementById('line');
        const rectBtn = document.getElementById('rect');
        const circleBtn = document.getElementById('circle');
        const fillBtn = document.getElementById('fill');
        const brushSize = document.getElementById('brushSize');
        const colorPicker = document.getElementById('color');
        const clearBtn = document.getElementById('clear');
        const saveBtn = document.getElementById('saveBtn');

        let tool = 'pencil';
        let isDrawing = false;
        let startX, startY;
        let currentColor = '#000000';
        let currentSize = 5;

        // Événements pour les outils
        pencilBtn.addEventListener('click', () => setTool('pencil'));
        eraserBtn.addEventListener('click', () => setTool('eraser'));
        lineBtn.addEventListener('click', () => setTool('line'));
        rectBtn.addEventListener('click', () => setTool('rect'));
        circleBtn.addEventListener('click', () => setTool('circle'));
        fillBtn.addEventListener('click', () => setTool('fill'));
        brushSize.addEventListener('input', (e) => currentSize = e.target.value);
        colorPicker.addEventListener('input', (e) => currentColor = e.target.value);
        clearBtn.addEventListener('click', () => ctx.clearRect(0, 0, canvas.width, canvas.height));
        saveBtn.addEventListener('click', () => {
            const link = document.createElement('a');
            link.download = 'mon-dessin.png';
            link.href = canvas.toDataURL();
            link.click();
        });

        function setTool(newTool) {
            tool = newTool;
            document.querySelectorAll('#toolbar button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(newTool === 'pencil' ? 'pencil' : newTool === 'eraser' ? 'eraser' : newTool === 'line' ? 'line' : newTool === 'rect' ? 'rect' : newTool === 'circle' ? 'circle' : 'fill').classList.add('active');
            canvas.style.cursor = newTool === 'eraser' ? 'grab' : 'crosshair';
        }

        // Événements de dessin
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);

        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            startX = e.clientX - rect.left;
            startY = e.clientY - rect.top;
            ctx.beginPath();
            ctx.moveTo(startX, startY);
        }

        function draw(e) {
            if (!isDrawing) return;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.strokeStyle = currentColor;
            ctx.lineWidth = currentSize;

            if (tool === 'pencil') {
                ctx.lineTo(x, y);
                ctx.stroke();
            } else if (tool === 'eraser') {
                ctx.strokeStyle = '#ffffff';
                ctx.lineTo(x, y);
                ctx.stroke();
                ctx.globalCompositeOperation = 'destination-out';
                ctx.stroke();
                ctx.globalCompositeOperation = 'source-over';
            } else if (tool === 'line') {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.beginPath();
                ctx.moveTo(startX, startY);
                ctx.lineTo(x, y);
                ctx.stroke();
            } else if (tool === 'rect') {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.strokeRect(startX, startY, x - startX, y - startY);
            } else if (tool === 'circle') {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                const radius = Math.sqrt(Math.pow(x - startX, 2) + Math.pow(y - startY, 2));
                ctx.beginPath();
                ctx.arc(startX, startY, radius, 0, 2 * Math.PI);
                ctx.stroke();
            }
        }

        function stopDrawing() {
            if (isDrawing && (tool === 'line' || tool === 'rect' || tool === 'circle')) {
                // Redessiner le dessin précédent si nécessaire, mais pour simplicité, on assume un nouveau dessin
            }
            isDrawing = false;
        }

        // Support pour le remplissage (basique, flood fill approximatif)
        fillBtn.addEventListener('click', () => {
            // Pour un vrai flood fill, implémentez une fonction plus avancée ; ici, un exemple simple
            ctx.fillStyle = currentColor;
            ctx.fillRect(0, 0, canvas.width, canvas.height); // Remplit tout, pour démo
        });

        // Initialisation
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
    </script>
</body>
</html>
